# LockSupport及线程中断

## 什么是中断机制

首先，一个线程不应该由其他线程来强制中断或停止，而是**应该由线程自己自行停止**，自己来决定自己的命运。所以，Thread.stop,Thread.suspend, Thread.resume都已经被废弃了。

其次，在Java中没有办法立即停止一条线程，然而停止线程却显得尤为重要，如取消一个耗时操作。因此，Java提供了一种用于停止线程的协商机制——中断，也即中断标识协商机制。

中断只是一种协作**协商机制**，Java没有给中断增加任何语法，中断的过程完全需要程序员自己实现。

若要中断一个线程，你需要手动调用该线程的interrupt方法，该方法也仅仅是将线程对象的中断标识设成true;

接着你需要自己写代码不断地检测当前线程的标识位，如果为true，表示别的线程请求这条线程中断，此时究竟该做什么需要你自己写代码实现。

<br/>

每个线程对象中都有一个中断标识位，用于表示线程是否被中断;该标识位为true表示中断，为false表示未中断;

通过调用线程对象的interrupt方法将该线程的标识位设为true;可以在别的线程中调用，也可以在自己的线程中调用。

## 中断相关API

| `void`           | `interrupt()` 实例方法，仅仅设置中断标志位为true，不会立刻停止线程 |
| ---------------- | ------------------------------------------------------------ |
| `static boolean` | `interrupted()` 静态方法。判断线程是否被中断，同时清除当前中断状态（中断标志位置false） |
| `boolean`        | `isInterrupted()` 通过检查中断标志位来判断是否被中断         |

## 相关考点

### 如何停止中断运行中的线程？

- 通过一个 `volatile` 变量实现。将一个静态 `volatile` 变量视为标志位，线程去判断这个标志位的状态，然后决定自己是否中断
- 通过 `AtomicBoolean` 。类似  `volatile` 变量
- 通过 Thread 类自带的中断 API 实现


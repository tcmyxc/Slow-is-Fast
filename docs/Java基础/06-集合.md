# 集合

## Collection接口

Collection 接口是 List、Set 和 Queue 接口的父接口，该接口里定义的方法既可用于操作 Set 集合，也可用于操作 List 和 Queue 集合

JDK不提供此接口的任何直接实现，而是提供更具体的子接口(如：Set和List)实现

在 Java5 之前，Java 集合会丢失容器中所有对象的数据类型，把所有对象都当成 Object 类型处理；从 JDK 5.0 增加了泛型以后，Java 集合可以记住容器中对象的数据类型。

### 常用方法

| Modifier and Type | Method and Description                                       |
| :---------------- | :----------------------------------------------------------- |
| `boolean`         | `add(E e)`                                                   |
| `boolean`         | `addAll(Collection<? extends E> c)`                          |
| `void`            | `clear()`                                                    |
| `boolean`         | `contains(Object o)`                                         |
| `boolean`         | `containsAll(Collection<?> c)` 比较两个集合的各个元素是否相同 |
| `boolean`         | `equals(Object o)`                                           |
| `int`             | `hashCode()`                                                 |
| `boolean`         | `isEmpty()`                                                  |
| `Iterator<E>`     | `iterator()` 返回迭代器对象，用于集合遍历                    |
| `boolean`         | `remove(Object o)`                                           |
| `boolean`         | `removeAll(Collection<?> c)` 差集                            |
| `boolean`         | `retainAll(Collection<?> c)` 交集                            |
| `int`             | `size()`                                                     |
| `Object[]`        | `toArray()` 转成对象数组                                     |
| `<T> T[]`         | `toArray(T[] a)`                                             |

<br/>

向 Collection 接口的实现类的对象中添加数据 obj 时，要求 obj 所在类重写 `equals` 方法

数组 --> 集合：调用 `Arrays` 类的 `asList` 静态方法

### 迭代器

- 提供一种方法访问一个容器(container)对象中各个元素，而又不需暴露该对象的内部细节。迭代器模式，就是为容器而生

- Iterator 仅用于遍历集合，Iterator 本身并不提供承装对象的能力。如果需要创建 Iterator 对象，则必须有一个被迭代的集合

- 集合对象每次调用iterator()方法都得到一个全新的迭代器对象，默认游标都在集合的第一个元素之前

| Modifier and Type | Method and Description              |
| ----------------- | ----------------------------------- |
| `boolean`         | `hasNext()`                         |
| `E`               | `next()`                            |
| `default void`    | `remove()` 删除迭代器的最后一个元素 |

标准遍历写法：

```java
while(iterator.hasNext()){
	System.out.println(iterator.next());
}
```



移除元素：

```java
Iterator iter = coll.iterator();//回到起点
while(iter.hasNext()){
    Object obj = iter.next();
    if(obj.equals("Tom")){
        iter.remove();
    }
}
```

Iterator 删除集合的元素，是遍历过程中通过迭代器对象的 remove 方法，不是集合对象的remove方法。 

如果还未调用 `next()` 或在上一次调用 `next` 方法之后已经调用了 `remove` 方法，再调用 `remove` 都会报`IllegalStateException`，即调用 `remove` 之前必须先调 `next`，而且必须成对使用

> 移除元素的操作不常使用

### 增强for循环

Java 5.0 提供了 foreach 循环迭代访问 **Collection 和数组**。

遍历操作不需获取Collection或数组的长度，无需使用索引访问元素；底层调用迭代器

<br/>

练习题

```java

String[] str = new String[5];
for (String myStr : str) {
    myStr = "atguigu";
    System.out.println(myStr);
}
for (int i = 0; i < str.length; i++) {
	System.out.println(str[i]);// 输出的全部
} 
```

数组元素不会被修改，因为增强for循环那里是定义了一个临时变量，对临时变量修改值，不会影响原始的数组的值

## List接口

List集合类中**元素有序、且可重复**，集合中的每个元素都有其对应的顺序索引

List容器中的元素都对应一个整数型的序号记载其在容器中的位置，可以根据序号存取容器中的元素

实现类常用的有：ArrayList、LinkedList 和 Vector

### 三个实现类的异同

同：都实现类 List 接口；存储数据的特点相同

不同：

1、ArrayList 是 List 接口的主要实现类；`Object` 数组实现，默认容量10；线程不安全，效率高；

2、LinkedList 底层使用双向链表实现；适合插入、删除操作多的；线程不安全

3、Vector 是最古老的实现类；`Object` 数组实现，默认容量10；线程安全，效率低；

### 源码和扩容机制

#### ArrayList扩容

默认1.5倍扩容（`int newCapacity = oldCapacity + (oldCapacity >> 1)`），然后复制元素到新数组（` Arrays.copyOf(elementData, newCapacity)`）

> 建议使用带参数的构造器，避免频繁扩容

<br/>

调用无参构造器：

- JDK7直接创建了一个容量为10的数组；
- JDK8最开始是一个容量是0的空数组，只有第一次调用`add`方法加入新元素的时候才会创建容量为10的空数组，然后把数据放到数组里面。后续添加和扩容和JDK7相同

总结：JDK7类似单例的饿汉模式，JDK8类似懒汉，延迟了数组的创建

#### Vector源码分析

调用无参构造直接创建了一个容量为10的空数组；扩容的时候，默认扩容为原来的2倍

> 基本不用，就算考虑线程安全也不用这个

### 常用方法

List除了从Collection集合继承的方法外，List 集合里添加了一些根据索引来操作集合元素的方法

| Modifier and Type | Method and Description                       |
| :---------------- | :------------------------------------------- |
| `boolean`         | `add(E e)` 增                                |
| `E`               | `remove(int index)` 删                       |
| `E`               | `set(int index, E element)` 改               |
| `E`               | `get(int index)` 查                          |
| `void`            | `add(int index, E element)` 插入             |
| `List<E>`         | `subList(int fromIndex, int toIndex)` 子列表 |



变量方法：迭代器遍历、增强for循环、普通for循环

<br/>

```java
public static void main(String[] args) {
    List list = new ArrayList();
    list.add(1);
    list.add(2);
    list.add(3);
    updateList(list);
    System.out.println(list);
}

private static void updateList(List list) {
    // list.remove(2);// 按照索引删的
    list.remove(new Integer(2));// 按照对象删的
}
```

## Set接口

Collection的子接口，set接口没有提供额外的方法

不允许包含相同的元素

判断两个对象是否相同不是使用 `==` 运算符，而是根据 `equals()` 方法

